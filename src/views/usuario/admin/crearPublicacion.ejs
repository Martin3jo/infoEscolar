<!DOCTYPE html>
<html lang="en">
  <%- include('../../partials/head', {titulo : publicacion ? 'Editar Publicación' : 'Crear Publicación' , estilo : 'crearProducto.css' }) %>

  <body>
    <%- include('../../partials/nav.ejs') %>
    <main class="main-adminProducto">
      <div class="form-registro">
        <form
          action="<%= publicacion ? '/usuario/perfil/publicacion/editarPublicacion/' + publicacion.idPublicacion : '/usuario/perfil/publicacion/crearPublicacion' %>"
          method="post"
          enctype="multipart/form-data"
          class="form-crearProducto e-form"
        >
          <!--TITULO-->
          <div class="input-box">
            <label for="titulo">Titulo</label>
            <input
              type="text"
              name="titulo"
              value="<%= publicacion ? publicacion.titulo : '' %>"
              class="e-marca"
              required
            />
            <!--comentario para los errores-->
            <% if (locals.errors && errors.titulo) { %>
            <div><%= errors.titulo.msg %></div>
            <% } %>
          </div>

          <!-- Noticia -->
          <div class="input-box">
            <label for="contenido">Noticia</label>
            <textarea
              class="e-descripcion"
              name="contenido"
              id="contenido"
              rows="10"
              required
            ><%= publicacion ? publicacion.contenido : '' %></textarea>
          </div>
          <!--comentario para los errores-->
          <% if (locals.errors && errors.contenido) { %>
          <div><%= errors.contenido.msg %></div>
          <% } %>

          <!--CATEGORIA-->
          <div class="input-box">
            <label for="categoria">Categoria</label>
            <select name="categoria" class="e-categoria" required>
              <% categorias.forEach(categoria => { %>
                <option value="<%= categoria.idCategoria %>" <%= publicacion && publicacion.idCategoria === categoria.idCategoria ? 'selected' : '' %>><%= categoria.nombre %></option>
              <% }) %>
            </select>
          </div>

          <!--IMAGEN-->
          <div class="input-box">
            <label for="imagen">Imagen:</label><br />
            <input
              type="file"
              class="imagen"
              name="imagen"
            />
            <!--comentario para los errores-->
            <% if (locals.errors && errors.imagen) { %>
            <div><%= errors.imagen.msg %></div>
            <% } %>
          </div>
          <div class="boton-crear">
            <button type="submit" name="accion" value="crear"><%= publicacion ? 'Modificar' : 'Crear' %></button>
          </div>
        </form>
      </div>
      <!--ERRORES FRONT-->
      <section class="errores-front">
        <ul></ul>
      </section>
      <div class="boton-volver">
        <a href="/usuario/perfil/publicacion"
          ><button><i class="fa-regular fa-circle-left"></i></button
        ></a>
      </div>
    </main>
    <!-- <%- include('../../partials/footer') %> -->
    <script src="/js/errors-forms.js"></script>
  </body>
</html>